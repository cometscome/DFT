<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>第一原理計算高速チュートリアル · 物性実験家のための無料でできる第一原理計算入門</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">物性実験家のための無料でできる第一原理計算入門</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../ASE/howtouse/">ASEでの第一原理計算入門</a></li><li><a class="tocitem" href="../../ASE/jupyter/">Jupyter notebookの使用</a></li><li class="is-active"><a class="tocitem" href>第一原理計算高速チュートリアル</a><ul class="internal"><li><a class="tocitem" href="#最初に行うこと-1"><span>最初に行うこと</span></a></li><li><a class="tocitem" href="#ASEのインストール-1"><span>ASEのインストール</span></a></li><li><a class="tocitem" href="#結晶構造の入手-1"><span>結晶構造の入手</span></a></li><li><a class="tocitem" href="#ASEでの第一原理計算-1"><span>ASEでの第一原理計算</span></a></li><li><a class="tocitem" href="#第一原理計算のテスト-1"><span>第一原理計算のテスト</span></a></li></ul></li><li><a class="tocitem" href="../../QM/QM0/">Quantum Espresso</a></li><li><a class="tocitem" href="../../chapter1/ASE/">Atomic Simulation Environment (ASE)</a></li><li><a class="tocitem" href="../../chapter1/MateriApps/">MateriApps LIVE!のインストール</a></li><li><a class="tocitem" href="../../chapter1/VirturlBox/">Virtual Boxのインストール</a></li><li><a class="tocitem" href="../../">物性実験家のための無料でできる第一原理計算入門</a></li><li><a class="tocitem" href="../../samples/samples/">ASEによる計算例</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>第一原理計算高速チュートリアル</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>第一原理計算高速チュートリアル</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cometscome/DFT/blob/master/docs/src/Fast/fast.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="第一原理計算高速チュートリアル-1"><a class="docs-heading-anchor" href="#第一原理計算高速チュートリアル-1">第一原理計算高速チュートリアル</a><a class="docs-heading-anchor-permalink" href="#第一原理計算高速チュートリアル-1" title="Permalink"></a></h1><p>一つ一つは見ていくのは面倒！という人のために、このページにあることを実行すれば第一原理計算ができるようにしました。 順番にやってみてください。固体の第一原理計算をQuantum Espressoで実行することを念頭においています。 ここに書いたことはあとで項別にまとめる予定です。</p><h2 id="最初に行うこと-1"><a class="docs-heading-anchor" href="#最初に行うこと-1">最初に行うこと</a><a class="docs-heading-anchor-permalink" href="#最初に行うこと-1" title="Permalink"></a></h2><p><a href="../../chapter1/MateriApps/#MateriApps-LIVE!のインストール-1">MateriApps LIVE!のインストール</a> をみて、MateriApps LIVE!のインストールを終わらせてください。</p><h2 id="ASEのインストール-1"><a class="docs-heading-anchor" href="#ASEのインストール-1">ASEのインストール</a><a class="docs-heading-anchor-permalink" href="#ASEのインストール-1" title="Permalink"></a></h2><p>左下のツバメみたいなアイコンをクリックして、System ToolsからLXTerminalを選んでターミナルを出し、 以下のものを打ち込んでください。これは全て仮想マシン上で行われていますので、お使いのPCへの影響は全くありませんので安心してください。</p><pre><code class="language-none">sudo curl -kL https://bootstrap.pypa.io/get-pip.py | sudo python3</code></pre><p>パスワードを聞かれますが、これはlive と打ち込んでください。 次に、</p><pre><code class="language-none">sudo python3 -m pip install --upgrade --user ase</code></pre><p>と入れてください。</p><p>次に <a href="../../ASE/jupyter/#Jupyter-Notebookの起動-1">Jupyter Notebookの起動</a> をみてJupyter notebookを起動してください。</p><h2 id="結晶構造の入手-1"><a class="docs-heading-anchor" href="#結晶構造の入手-1">結晶構造の入手</a><a class="docs-heading-anchor-permalink" href="#結晶構造の入手-1" title="Permalink"></a></h2><p>左下のツバメメニューからWebブラウザFirefoxを起動し、Materials Project URL:https://materialsproject.org/ に移動してください。 ここには様々な固体の情報がデータベース化されています。 無料で利用できますので、googleアカウントをお持ちであれば簡単にログインできます。</p><h3 id="NaClの構造の入手-1"><a class="docs-heading-anchor" href="#NaClの構造の入手-1">NaClの構造の入手</a><a class="docs-heading-anchor-permalink" href="#NaClの構造の入手-1" title="Permalink"></a></h3><p>さて、NaClの構造を入手してみましょう。 周期表の表示があるので、そこでNaをクリックするか、あるいは検索窓にNa-Clなどと入れれば見つけることができます。 NaClのどれかをクリックして表示させます。 ここで、</p><p><img src="../download.png" alt="fig1"/></p><p>のCIFをクリックし、「Computed」を選んでみましょう。 これでDownloadsディレクトリにファイルがダウンロードされました。</p><h3 id="Vestaによる結晶構造の確認-1"><a class="docs-heading-anchor" href="#Vestaによる結晶構造の確認-1">Vestaによる結晶構造の確認</a><a class="docs-heading-anchor-permalink" href="#Vestaによる結晶構造の確認-1" title="Permalink"></a></h3><p>次に、ターミナルに戻ります。 ここで、</p><pre><code class="language-none"> cd ~/Downloads/</code></pre><p>でDownloadsディレクトリに移動すると、ファイルがあるのがわかると思います。 そして、</p><pre><code class="language-none">vesta NaCl_mp-22862_computed.cif</code></pre><p>とすればVESTAが立ち上がり、結晶構造を見ることができます。 VESTAは非常に優秀な「結晶構造、電子・核密度等の三次元データ、及び結晶外形の可視化プログラム」です。 https://jp-minerals.org/vesta/jp/</p><h2 id="ASEでの第一原理計算-1"><a class="docs-heading-anchor" href="#ASEでの第一原理計算-1">ASEでの第一原理計算</a><a class="docs-heading-anchor-permalink" href="#ASEでの第一原理計算-1" title="Permalink"></a></h2><h3 id="ASEでの取り込み-1"><a class="docs-heading-anchor" href="#ASEでの取り込み-1">ASEでの取り込み</a><a class="docs-heading-anchor-permalink" href="#ASEでの取り込み-1" title="Permalink"></a></h3><p>保存したファイルをjupyter notebookでASEを使って取り扱ってみましょう。 保存したファイルは</p><pre><code class="language-none">cp ~/Downloads/NaCl_mp-22862_computed.cif ~/ASE/</code></pre><p>で作ったフォルダにコピーしておきましょう。 あとは</p><pre><code class="language-none">import ase.io 
rocksalt =ase.io.read(&quot;NaCl_mp-22862_computed.cif&quot;)</code></pre><p>すれば読み込むことができます。</p><h3 id="第一原理計算のテスト実行-1"><a class="docs-heading-anchor" href="#第一原理計算のテスト実行-1">第一原理計算のテスト実行</a><a class="docs-heading-anchor-permalink" href="#第一原理計算のテスト実行-1" title="Permalink"></a></h3><p>このあとは、</p><p><a href="../../samples/samples/#NaCl結晶の格子定数-1">NaCl結晶の格子定数</a> のようにやればよいです。</p><p>具体的には、ターミナルでまず</p><p>擬ポテンシャルのダウンロード：</p><pre><code class="language-bash">cd /usr/share/espresso/pseudo
sudo wget https://www.quantum-espresso.org/upf_files/Na.pbe-spn-kjpaw_psl.1.0.0.UPF
sudo wget https://www.quantum-espresso.org/upf_files/Cl.pbe-n-rrkjus_psl.1.0.0.UPF</code></pre><p>NaとClの擬ポテンシャルをダウンロードします。なお、他の擬ポテンシャルは https://www.quantum-espresso.org/pseudopotentials にあります。</p><p>次に、Jupyter notebook上で</p><pre><code class="language-python">from ase.build import bulk
from ase.calculators.espresso import Espresso
from ase.constraints import UnitCellFilter
from ase.optimize import LBFGS
import ase.io 

pseudopotentials = {&#39;Na&#39;: &#39;Na.pbe-spn-kjpaw_psl.1.0.0.UPF&#39;,
                    &#39;Cl&#39;: &#39;Cl.pbe-n-rrkjus_psl.1.0.0.UPF&#39;}
#rocksalt = bulk(&#39;NaCl&#39;, crystalstructure=&#39;rocksalt&#39;, a=6.0)
rocksalt =ase.io.read(&quot;NaCl_mp-22862_computed.cif&quot;) #Material Projectでダウンロードしたものを使う場合。
calc = Espresso(pseudopotentials=pseudopotentials,
                tstress=True, tprnfor=True, kpts=(3, 3, 3))

rocksalt.set_calculator(calc)

ucf = UnitCellFilter(rocksalt)
opt = LBFGS(ucf)
opt.run(fmax=0.005)

# cubic lattic constant
print((8*rocksalt.get_volume()/len(rocksalt))**(1.0/3.0))</code></pre><p>コードでは、格子定数を最初は6として、設定したあと、構造最適化をしています。最後に、構造最適化して出てきた格子定数をプリントしています。</p><p>これを実行すると、</p><pre><code class="language-none">       Step     Time          Energy         fmax
LBFGS:    0 21:27:48    -1960.836397        0.0625
LBFGS:    1 21:28:01    -1960.836540        0.0501
LBFGS:    2 21:28:13    -1960.834692        0.0338
LBFGS:    3 21:28:26    -1960.833702        0.0079
LBFGS:    4 21:28:39    -1960.834037        0.0006
5.661404166984403</code></pre><p>と出ます。 これで第一原理計算でNaClの構造最適化ができました。</p><h2 id="第一原理計算のテスト-1"><a class="docs-heading-anchor" href="#第一原理計算のテスト-1">第一原理計算のテスト</a><a class="docs-heading-anchor-permalink" href="#第一原理計算のテスト-1" title="Permalink"></a></h2><h3 id="Siのバンド構造-1"><a class="docs-heading-anchor" href="#Siのバンド構造-1">Siのバンド構造</a><a class="docs-heading-anchor-permalink" href="#Siのバンド構造-1" title="Permalink"></a></h3><p>Siのバンド計算をやってみましょう。 まず、バルクのSiを用意し、計算としてQuantum Espressoを使うことにします。</p><pre><code class="language-python">from ase.build import bulk
from ase.calculators.espresso import Espresso
atoms = bulk(&quot;Si&quot;) #バルクのSiの用意
pseudopotentials = {&#39;Si&#39;:&#39;Si.pz-vbc.UPF&#39;} #擬ポテンシャルの設定


input_data = {
    &#39;system&#39;: {
        &#39;ecutwfc&#39;: 64,
        &#39;ecutrho&#39;: 576,
        &#39;nbnd&#39; : 12 },
    &#39;disk_io&#39;: &#39;low&#39;}  #Quantum Espressoのパラメータ

calc = Espresso(pseudopotentials=pseudopotentials,kpts=(4, 4, 4),input_data=input_data)
atoms.set_calculator(calc)</code></pre><p>Quantum Espressoのパラメータを<code>input_data</code>で入れることができます。 詳しくは http://www.stat.phys.titech.ac.jp/SATL<em>qe</em>tutorial/index.html が参考になると思います。</p><p>ここのcalcを別のものにすると、別の第一原理計算ソフトを使うことができます。 原子配置が与えられた時にエネルギーが返ってくればいいので、第一原理計算である必要もありません。 詳しくは https://wiki.fysik.dtu.dk/ase/ase/calculators/calculators.html を見てみてください。</p><p>次に、自己無撞着計算をして、電子密度を決定します。電子密度が決定されれば、各k点での計算をすることでバンド図を 描くことができます。</p><pre><code class="language-python">atoms.get_potential_energy()
fermi_level = calc.get_fermi_level()
print(fermi_level)</code></pre><p>次に、バンド図用のバンド計算を行います。</p><pre><code class="language-python">input_data.update({&#39;calculation&#39;:&#39;bands&#39;,
                              &#39;restart_mode&#39;:&#39;restart&#39;,
                               &#39;verbosity&#39;:&#39;high&#39;})
calc.set(kpts={&#39;path&#39;:&#39;LGXWG&#39;, &#39;npoints&#39;:100},
          input_data=input_data)
calc.calculate(atoms)</code></pre><p>となります。ここで、kptsのpathに好きなブリルアンゾーンの点を入れることで、簡単にバンド図を描くことができるのがASEの面白い点です。 L点、Gamma点、X点、W点、Gamma点の順番にバンドを描きます。</p><p>計算が終わったら、図をプロットしましょう。</p><pre><code class="language-python">import matplotlib.pyplot as plt

bs = calc.band_structure()
bs.reference = fermi_level

bs.plot(emax=15, filename=&#39;Si.png&#39;)</code></pre><p>でできます。</p><p>得られた図は</p><p><img src="../Si.png" alt="fig2"/></p><p>となります。よくみるSiのバンド図になっていますね。</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../ASE/jupyter/">« Jupyter notebookの使用</a><a class="docs-footer-nextpage" href="../../QM/QM0/">Quantum Espresso »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 29 March 2020 19:46">Sunday 29 March 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
